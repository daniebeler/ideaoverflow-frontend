<ion-header class="ion-no-border">
  <ion-grid class="container">
    <ion-row>
      <ion-col size="auto">
        <button type="button" class="btn-small btn-medium" (click)="gotoProfile()">
          <ion-icon name="chevron-back-outline"></ion-icon>
        </button>
      </ion-col>
      <ion-col>
        <h2>Settings</h2>
      </ion-col>
      <ion-col size="auto">
        <button type="button" class="btn-small btn-primary save-btn" (click)="updateUser()"
          [disabled]="socialsForm.invalid || personalForm.invalid || !unsavedDataExists">
          <span>Save changes</span>
        </button>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-header>

<ion-content>
  <ion-grid class="container" style="margin-top: 30px; margin-bottom: 30px;" *ngIf="user">

    <ion-row>
      <ion-col>
        <h2>Theme Color</h2>
      </ion-col>
    </ion-row>
    <ion-row style="padding-bottom: 30px">

      <ion-col *ngFor="let color of colors" style="padding-bottom: 0;" size="auto">
        <span [ngStyle]="{'background-color': color}" [ngClass]="color === user.color ? 'dot-active' : 'dot'"
          (click)="updateColor(color)"></span>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <h2>Personal</h2>
      </ion-col>
    </ion-row>

    <ion-row style="margin-bottom: 50px;">
      <ion-col style="display: flex;" class="ion-justify-content-center">
        <div class="profile-pic-div">
          <img [src]="user.profileimage" id="photo">
          <input type="file" id="file" accept=".png,.jpg," (change)="onFileChange($event)">
          <label for="file" id="uploadBtn">Change</label>
        </div>
      </ion-col>
    </ion-row>

    <form [formGroup]="personalForm" autocomplete="off">

      <ion-row>
        <ion-col size-xs="12" size-sm="6">
          <div class="form-group">
            <label class="text-label" for="firstname">Firstname</label>
            <input id="firstname" formControlName="firstname" placeholder="John" [(ngModel)]="user.firstname" />
          </div>
        </ion-col>

        <ion-col size-xs="12" size-sm="6">
          <div class="form-group">
            <label class="text-label" for="lastname">Lastname</label>
            <input id="lastname" formControlName="lastname" placeholder="Doe" [(ngModel)]="user.lastname" />
          </div>
        </ion-col>
      </ion-row>

      <ion-row>
        <ion-col size-xs="12">
          <div class="form-group" *ngIf="countries">
            <label class="text-label">Country</label>
            <select [(ngModel)]="country" formControlName="country">
              <option value="">--Leave empty--</option>
              <option *ngFor="let country of countries.countries" [ngValue]="country.code">{{country.name}}</option>
            </select>
          </div>
        </ion-col>
      </ion-row>

      <ion-row>
        <ion-col style="padding-bottom: 0;">
          <div class="form-group">
            <label class="text-label" for="bio">Bio</label>
            <textarea style="resize: none;" rows="5" formControlName="bio" id="bio"
              placeholder="Something about myself..." [(ngModel)]="user.bio"></textarea>
          </div>
        </ion-col>
      </ion-row>
    </form>

    <ion-row>
      <ion-col>
        <h2>Social Media</h2>
        <form [formGroup]="socialsForm" autocomplete="off">
          <div class="form-group">
            <label class="icon-label" for="instagram">
              <ion-icon name="logo-instagram" class="logo-instagram"></ion-icon>
            </label>
            <input class="icon-input" id="instagram" formControlName="instagram" placeholder="Instagram username"
              [(ngModel)]="user.instagram" />
          </div>

          <div class="form-group">
            <label class="icon-label" for="twitter">
              <ion-icon name="logo-twitter" class="logo-twitter"></ion-icon>
            </label>
            <input class="icon-input" id="twitter" formControlName="twitter" placeholder="Twitter username"
              [(ngModel)]="user.twitter" />
          </div>

          <div class="form-group">
            <label class="icon-label" for="dribbble">
              <ion-icon name="logo-dribbble" class="logo-dribbble"></ion-icon>
            </label>
            <input class="icon-input" id="dribbble" formControlName="dribbble" placeholder="Dribbble username"
              [(ngModel)]="user.dribbble" />
          </div>

          <div class="form-group">
            <label class="icon-label" for="github">
              <ion-icon name="logo-github" class="logo-github"></ion-icon>
            </label>
            <input class="icon-input" id="github" formControlName="github" placeholder="Github username"
              [(ngModel)]="user.github" />
          </div>

          <div class="form-group">
            <label class="icon-label" for="linkedin">
              <ion-icon name="logo-linkedin" class="logo-linkedin"></ion-icon>
            </label>
            <input class="icon-input" id="linkedin" formControlName="linkedin" placeholder="Linkedin username"
              [(ngModel)]="user.linkedin" />
          </div>

          <div class="form-group">
            <label class="icon-label" for="website">
              <ion-icon name="globe-outline" class="logo-website"></ion-icon>
            </label>
            <input class="icon-input" id="website" type="url" formControlName="website" placeholder="Website URL"
              [(ngModel)]="user.website" />
          </div>
        </form>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col>
        <h2>Change Password</h2>

        <form [formGroup]="passwordForm">
          <div class="form-group">
            <label class="icon-label" for="password">
              <ion-icon name="lock-open"></ion-icon>
            </label>
            <input class="icon-input" type="password" name="passwort" id="password" formControlName="old"
              placeholder="Current Password" [(ngModel)]="oldPassword" />
          </div>

          <div class="form-group">
            <label class="icon-label" for="password"><ion-icon name="lock-closed"></ion-icon></label>
            <input class="icon-input" type="password" name="passwort" id="password" formControlName="new" placeholder="New Password"
              [(ngModel)]="newPassword1" />
          </div>

          <div class="form-group">
            <label class="icon-label" for="password"><ion-icon name="lock-closed"></ion-icon></label>
            <input class="icon-input" type="password" name="passwort" id="password" formControlName="repeat" placeholder="New Password"
              [(ngModel)]="newPassword2" />
          </div>

          <div class="row d-flex justify-content-center submit-button-container">
            <button type="button" class="btn-large btn-primary" [disabled]="passwordForm.invalid"
              (click)="changePassword()">Change
              Password</button>
          </div>

        </form>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-content>
