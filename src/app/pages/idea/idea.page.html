<ion-header class="ion-no-border">
  <ion-grid class="container">
    <ion-row>
      <ion-col size="auto">
        <button type="button" class="btn-small btn-medium" (click)="goBack()">
          <ion-icon name="chevron-back-outline"></ion-icon>
        </button>
      </ion-col>
      <ion-col>
        <h2 *ngIf="idea">{{idea.title}}</h2>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-header>

<ion-content *ngIf="idea">
  <ion-grid class="container">
    <ion-row class="idea-wrapper">
      <ion-col>
        <app-idea-component [post]="idea" [loggedIn]="currentUser !== null"></app-idea-component>
      </ion-col>
    </ion-row>

    <ion-row class="write-comment-wrapper">

      <hr>
      <ion-col>
        <form [formGroup]="commentForm" autocomplete="off">
          <div class="form-group">
            <input type="text" name="comment" id="comment" maxlength="255" formControlName="comment"
              placeholder="Leave a comment..." />
          </div>
        </form>
      </ion-col>

      <ion-col size="auto">
        <button type="button" class="btn-small btn-primary" (click)="sendComment()">
          <ion-icon name="send-outline" [ngClass]="{'rotate': sending}"></ion-icon>
        </button>
      </ion-col>
    </ion-row>

    <div class="outer-comment-wrapper">
      <ion-row *ngFor="let comment of idea.comments">
      <hr>
      <ion-col>
        <ion-grid class="comment-wrapper">
          <ion-row>
            <ion-col size="auto">
              <ion-avatar>
                <img [src]="comment.user.profileimage">
              </ion-avatar>
            </ion-col>
            <ion-col class="name-wrapper">
              <p class="fullname">{{comment.user.firstname + ' ' + comment.user.lastname}}</p>
              <p class="username">@{{comment.user.username}}</p>
            </ion-col>

            <ion-col size="auto" *ngIf="comment.mine">
              <button type="button" class="btn-small btn-medium" (click)="deleteComment(comment.id)">
                <ion-icon name="trash-outline"></ion-icon>
              </button>
            </ion-col>
          </ion-row>

          <ion-row>
            <ion-col>
              {{comment.body}}
            </ion-col>
          </ion-row>
        </ion-grid>
      </ion-col>
    </ion-row>
    </div>

  </ion-grid>

  <app-footer></app-footer>
</ion-content>
